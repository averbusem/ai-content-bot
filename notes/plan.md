# üìã –ü–õ–ê–ù –†–ï–ê–õ–ò–ó–ê–¶–ò–ò TELEGRAM-–ë–û–¢–ê –î–õ–Ø –ù–ö–û

## üéØ –û–ë–©–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø

**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å Telegram-–±–æ—Ç–∞ –¥–ª—è –ø–æ–º–æ—â–∏ –ù–ö–û –≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π.

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫:**
- aiogram 3.22.0
- Redis –¥–ª—è FSM –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ù–ö–û
- pydantic-settings –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–í–∞–∂–Ω–æ:** –ù–∞ –¥–∞–Ω–Ω–æ–º —ç—Ç–∞–ø–µ AI-—Å–µ—Ä–≤–∏—Å—ã –Ω–µ —Ä–µ–∞–ª–∏–∑—É—é—Ç—Å—è. –§–æ–∫—É—Å –Ω–∞ —Å–±–æ—Ä–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ –∏ —Ä–∞–±–æ—Ç–µ —Å –±–æ—Ç–æ–º.

---

## üì¶ –≠–¢–ê–ü 1: –ë–ê–ó–û–í–ê–Ø –ò–ù–§–†–ê–°–¢–†–£–ö–¢–£–†–ê –ò –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ

### 1.1 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
- [x] –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞–Ω–∞
- [x] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Redis —á–µ—Ä–µ–∑ docker-compose
- [x] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ pydantic-settings
- [x] Middleware –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä

### 1.2 –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
**–ó–∞–¥–∞—á–∏:**
- [x] –°–æ–∑–¥–∞—Ç—å State –∫–ª–∞—Å—Å –¥–ª—è –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω)
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å handler –¥–ª—è –∫–æ–º–∞–Ω–¥—ã /start —Å –≥–ª–∞–≤–Ω—ã–º –º–µ–Ω—é
- [x] –°–æ–∑–¥–∞—Ç—å inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é —Å –∫–Ω–æ–ø–∫–∞–º–∏:
  - üìù –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞
  - üé® –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç–∏–Ω–∫–∏
  - ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–æ—Ä —Ç–µ–∫—Å—Ç–∞ (–∑–∞–≥–ª—É—à–∫–∞ "—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∑–∂–µ")
  - üìÖ –ö–æ–Ω—Ç–µ–Ω—Ç-–ø–ª–∞–Ω (–∑–∞–≥–ª—É—à–∫–∞ "—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∑–∂–µ")
  - ‚öôÔ∏è –†–∞—Å—Å–∫–∞–∑–∞—Ç—å –æ–± –ù–ö–û
  - ‚ùì –ü–æ–º–æ—â—å
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å callback handlers –¥–ª—è –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é
- [x] –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "üîô –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é" –≤ –Ω—É–∂–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö

**–§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/bot/states.py` - –¥–æ–±–∞–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- `src/bot/keyboards.py` - —Å–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é
- `src/bot/handlers/start.py` - –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å handler
- `src/bot/handlers/menu.py` - —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–µ–Ω—é

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å 6 –∫–Ω–æ–ø–∫–∞–º–∏, –≤—Å–µ –∫–Ω–æ–ø–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∏ –≤–µ–¥—É—Ç –∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º —Ä–∞–∑–¥–µ–ª–∞–º.

---

## üìù –≠–¢–ê–ü 2: –ù–ê–°–¢–†–û–ô–ö–ê –î–ê–ù–ù–´–• –û–ë –ù–ö–û

### 2.1 –≠–∫—Ä–∞–Ω "–†–∞—Å—Å–∫–∞–∑–∞—Ç—å –æ–± –ù–ö–û"
**–ó–∞–¥–∞—á–∏:**
- [x] –°–æ–∑–¥–∞—Ç—å State –∫–ª–∞—Å—Å `NKODataStates` –¥–ª—è —Ñ–ª–æ—É –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å handler –¥–ª—è –∫–Ω–æ–ø–∫–∏ "‚öôÔ∏è –†–∞—Å—Å–∫–∞–∑–∞—Ç—å –æ–± –ù–ö–û"
- [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –¥–∞–Ω–Ω—ã—Ö –ù–ö–û –≤ Redis
- [x] –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç - –ø–æ–∫–∞–∑–∞—Ç—å —ç–∫—Ä–∞–Ω —Å –∫–Ω–æ–ø–∫–∞–º–∏ "üìù –ó–∞–ø–æ–ª–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ" –∏ "üîô –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é"
- [x] –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –µ—Å—Ç—å - –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏ "‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ", "üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ", "üîô –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é"
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ù–ö–û

**–§–∞–π–ª—ã:**
- `src/bot/states.py` - –¥–æ–±–∞–≤–∏—Ç—å `NKODataStates`
- `src/bot/handlers/nko_data.py` - —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª
- `src/services/nko_service.py` - —Å–æ–∑–¥–∞—Ç—å —Å–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –ù–ö–û –≤ Redis

### 2.2 –§–ª–æ—É –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (5 –≤–æ–ø—Ä–æ—Å–æ–≤)
**–ó–∞–¥–∞—á–∏:**
- [x] –í–æ–ø—Ä–æ—Å 1/5: –ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
  - Handler –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞
  - –í–∞–ª–∏–¥–∞—Ü–∏—è (–Ω–µ –ø—É—Å—Ç–æ–µ)
- [x] –í–æ–ø—Ä–æ—Å 2/5: –î–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ù–ö–û
  - Handler –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞
  - –í–∞–ª–∏–¥–∞—Ü–∏—è (–Ω–µ –ø—É—Å—Ç–æ–µ)
- [x] –í–æ–ø—Ä–æ—Å 3/5: –§–æ—Ä–º—ã –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä)
  - Inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å —á–µ–∫–±–æ–∫—Å–∞–º–∏ –∏–ª–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –≤—ã–±–æ—Ä–æ–º
  - –ö–Ω–æ–ø–∫–∏: üéØ –ü—Ä–æ–µ–∫—Ç—ã, üé™ –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è, üí∞ –°–±–æ—Ä –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏–π, ü§ù –í–æ–ª–æ–Ω—Ç—ë—Ä—Å—Ç–≤–æ, üìö –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ, üè• –ê–¥—Ä–µ—Å–Ω–∞—è –ø–æ–º–æ—â—å, üì¢ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞, ‚úèÔ∏è –î—Ä—É–≥–æ–µ
  - –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–æ "–î—Ä—É–≥–æ–µ" - –∑–∞–ø—Ä–æ—Å —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è
  - –ö–Ω–æ–ø–∫–∞ "‚û°Ô∏è –î–∞–ª–µ–µ" –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞
- [x] –í–æ–ø—Ä–æ—Å 4/5: –†–µ–≥–∏–æ–Ω —Ä–∞–±–æ—Ç—ã
  - Handler –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞
  - –ö–Ω–æ–ø–∫–∞ "‚è≠Ô∏è –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å"
- [x] –í–æ–ø—Ä–æ—Å 5/5: –ö–æ–Ω—Ç–∞–∫—Ç—ã
  - Handler –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞
  - –ö–Ω–æ–ø–∫–∞ "‚è≠Ô∏è –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å"
- [x] –§–∏–Ω–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö
  - –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –≤–≤–µ–¥—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Redis
  - –ö–Ω–æ–ø–∫–∞ "üè† –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"

**–§–∞–π–ª—ã:**
- `src/bot/states.py` - –¥–æ–±–∞–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
- `src/bot/handlers/nko_data.py` - handlers –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
- `src/services/nko_service.py` - –º–µ—Ç–æ–¥—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è/–∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∑–∞–ø–æ–ª–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ–± –ù–ö–û —á–µ—Ä–µ–∑ –ø–æ—à–∞–≥–æ–≤—ã–π —Ñ–ª–æ—É, –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ Redis –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –≤—Ö–æ–¥–µ.

---

## ‚ùì –≠–¢–ê–ü 3: –†–ê–ó–î–ï–õ "–ü–û–ú–û–©–¨"

### 3.1 Handler –¥–ª—è –ø–æ–º–æ—â–∏
**–ó–∞–¥–∞—á–∏:**
- [x] –°–æ–∑–¥–∞—Ç—å handler –¥–ª—è –∫–Ω–æ–ø–∫–∏ "‚ùì –ü–æ–º–æ—â—å"
- [x] –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–π –±–æ—Ç–∞
- [x] –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "üîô –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é"

**–§–∞–π–ª—ã:**
- `src/bot/handlers/help.py` - —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π –±–æ—Ç–∞.

---

## üìù –≠–¢–ê–ü 4: –ì–ï–ù–ï–†–ê–¶–ò–Ø –¢–ï–ö–°–¢–ê - –í–ê–†–ò–ê–ù–¢ –ê (–°–í–û–ë–û–î–ù–´–ô –¢–ï–ö–°–¢)

### 4.1 –≠–∫—Ä–∞–Ω –≤—ã–±–æ—Ä–∞ —Å–ø–æ—Å–æ–±–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
**–ó–∞–¥–∞—á–∏:**
- [x] –°–æ–∑–¥–∞—Ç—å State –∫–ª–∞—Å—Å `TextGenerationStates` –¥–ª—è —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
- [x] –°–æ–∑–¥–∞—Ç—å State –∫–ª–∞—Å—Å `TextGenerationStructStates` –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ–æ—Ä–º—ã
- [x] Handler –¥–ª—è –∫–Ω–æ–ø–∫–∏ "üìù –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞"
- [x] Inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å –≤—ã–±–æ—Ä–æ–º:
  - üí¨ –°–≤–æ–±–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç
  - üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞
  - üîô –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é

**–§–∞–π–ª—ã:**
- `src/bot/states.py` - –¥–æ–±–∞–≤–∏—Ç—å `TextGenerationStates` –∏ `TextGenerationStructStates`
- `src/bot/handlers/text_generation.py` - —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª –¥–ª—è —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
- `src/bot/handlers/text_generation_struct.py` - —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ–æ—Ä–º—ã

### 4.2 –§–ª–æ—É "–°–≤–æ–±–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç"
**–ó–∞–¥–∞—á–∏:**
- [x] Handler –¥–ª—è –∫–Ω–æ–ø–∫–∏ "üí¨ –°–≤–æ–±–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç"
- [x] –°–æ–æ–±—â–µ–Ω–∏–µ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏
- [x] Handler –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –∏–ª–∏ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ - —á–µ—Ä–µ–∑ API Telegram)
- [x] –°–±–æ—Ä –ø—Ä–æ–º–ø—Ç–∞ (—Ç–µ–∫—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è + –¥–∞–Ω–Ω—ã–µ –ù–ö–û –∏–∑ Redis)
- [x] –ó–∞–≥–ª—É—à–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (–ø–æ–∫–∞ –±–µ–∑ AI):
  - –ü–æ–∫–∞–∑–∞—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é –∑–∞–≥—Ä—É–∑–∫–∏
  - –í–µ—Ä–Ω—É—Ç—å 1 –ø–æ—Å—Ç (–∑–∞–≥–ª—É—à–∫–∞ –∏–ª–∏ —à–∞–±–ª–æ–Ω)
- [x] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ (1 –ø–æ—Å—Ç)
- [x] Inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:
  - ‚úÖ –í—Å—ë –æ—Ç–ª–∏—á–Ω–æ, —Å–ø–∞—Å–∏–±–æ!
  - ‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å
  - üè† –í –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é

**–§–∞–π–ª—ã:**
- `src/bot/states.py` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `TextGenerationStates` –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏–π —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
- `src/bot/handlers/text_generation.py` - handlers –¥–ª—è —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
- `src/services/prompt_builder.py` - —Å–µ—Ä–≤–∏—Å –¥–ª—è —Å–±–æ—Ä–∫–∏ –ø—Ä–æ–º–ø—Ç–∞ –∏–∑ –¥–∞–Ω–Ω—ã—Ö –ù–ö–û –∏ —Ç–µ–∫—Å—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `src/services/text_generation_service.py` - –∑–∞–≥–ª—É—à–∫–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (–ø–æ–∫–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —à–∞–±–ª–æ–Ω—ã)

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–≤–µ—Å—Ç–∏ —Å–≤–æ–±–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç, –ø–æ–ª—É—á–∏—Ç—å 1 –ø–æ—Å—Ç (–ø–æ–∫–∞ –∑–∞–≥–ª—É—à–∫–∞), –º–æ–∂–µ—Ç –∑–∞–ø—Ä–æ—Å–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.

---

## üìã –≠–¢–ê–ü 5: –ì–ï–ù–ï–†–ê–¶–ò–Ø –¢–ï–ö–°–¢–ê - –í–ê–†–ò–ê–ù–¢ –ë (–°–¢–†–£–ö–¢–£–†–ò–†–û–í–ê–ù–ù–ê–Ø –§–û–†–ú–ê)

### 5.1 –§–ª–æ—É —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ–æ—Ä–º—ã (10 –≤–æ–ø—Ä–æ—Å–æ–≤)
**–ó–∞–¥–∞—á–∏:**
- [ ] Handler –¥–ª—è –∫–Ω–æ–ø–∫–∏ "üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞"
- [ ] –ö–Ω–æ–ø–∫–∞ "‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å"
- [ ] –í–æ–ø—Ä–æ—Å 1/10: –û –∫–∞–∫–æ–º —Å–æ–±—ã—Ç–∏–∏ –ø–æ—Å—Ç? (—Ç–µ–∫—Å—Ç/–≥–æ–ª–æ—Å)
- [ ] –í–æ–ø—Ä–æ—Å 2/10: –û–ø–∏—Å–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –ø–æ–¥—Ä–æ–±–Ω–µ–µ (—Ç–µ–∫—Å—Ç/–≥–æ–ª–æ—Å)
- [ ] –í–æ–ø—Ä–æ—Å 3/10: –ì–ª–∞–≤–Ω–∞—è —Ü–µ–ª—å –ø–æ—Å—Ç–∞
  - Inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞: üì£ –†–µ–∑—É–ª—å—Ç–∞—Ç, üôã –í–æ–ª–æ–Ω—Ç—ë—Ä—ã, üí∞ –ü–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏—è, ‚ú® –†–∞–±–æ—Ç–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, ‚ù§Ô∏è –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å, üìÖ –ê–Ω–æ–Ω—Å, ‚úèÔ∏è –î—Ä—É–≥–æ–µ
  - –ï—Å–ª–∏ "–î—Ä—É–≥–æ–µ" - —Ç–µ–∫—Å—Ç–æ–≤—ã–π –≤–≤–æ–¥
- [ ] –í–æ–ø—Ä–æ—Å 4/10: –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è (—Ç–µ–∫—Å—Ç)
- [ ] –í–æ–ø—Ä–æ—Å 5/10: –ú–µ—Å—Ç–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è (—Ç–µ–∫—Å—Ç)
- [ ] –í–æ–ø—Ä–æ—Å 6/10: –ü–ª–æ—â–∞–¥–∫–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
  - Inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞: üí¨ Telegram, üñãÔ∏è –í–ö–æ–Ω—Ç–∞–∫—Ç–µ, üåê –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ
- [ ] –í–æ–ø—Ä–æ—Å 7/10: –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è
  - Inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞: üë• –ú–µ—Å—Ç–Ω—ã–µ –∂–∏—Ç–µ–ª–∏, üéì –ú–æ–ª–æ–¥—ë–∂—å, üí∏ –î–æ–Ω–æ—Ä—ã, ü§ù –í–æ–ª–æ–Ω—Ç—ë—Ä—ã, üì∞ –°–ú–ò, üåç –®–∏—Ä–æ–∫–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è
- [ ] –í–æ–ø—Ä–æ—Å 8/10: –°—Ç–∏–ª—å —Ç–µ–∫—Å—Ç–∞
  - Inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞: ‚ù§Ô∏è –¢—ë–ø–ª—ã–π, üìä –° —Ñ–∞–∫—Ç–∞–º–∏, üí¨ –ü—Ä–æ—Å—Ç–æ, üß≠ –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ, üî• –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
- [ ] –í–æ–ø—Ä–æ—Å 9/10: –û–±—ä—ë–º —Ç–µ–∫—Å—Ç–∞
  - Inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞: ‚úÇÔ∏è –ö–æ—Ä–æ—Ç–∫–æ, üìÑ –°—Ä–µ–¥–Ω–µ, üìö –ü–æ–¥—Ä–æ–±–Ω–æ
- [ ] –í–æ–ø—Ä–æ—Å 10/10: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (—Ç–µ–∫—Å—Ç, –º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å)
- [ ] –°–±–æ—Ä –≤—Å–µ—Ö –æ—Ç–≤–µ—Ç–æ–≤ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç
- [ ] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è (–∑–∞–≥–ª—É—à–∫–∞) –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ 1 –ø–æ—Å—Ç–∞
- [ ] –¢–µ –∂–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, —á—Ç–æ –∏ –≤ –≤–∞—Ä–∏–∞–Ω—Ç–µ –ê

**–§–∞–π–ª—ã:**
- `src/bot/states.py` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `TextGenerationStructStates` –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏–π —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ–æ—Ä–º—ã (10 —Å–æ—Å—Ç–æ—è–Ω–∏–π –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤)
- `src/bot/handlers/text_generation_struct.py` - handlers –¥–ª—è –≤—Å–µ—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ–æ—Ä–º—ã
- `src/services/prompt_builder.py` - –º–µ—Ç–æ–¥ –¥–ª—è —Å–±–æ—Ä–∫–∏ –ø—Ä–æ–º–ø—Ç–∞ –∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ 10 –≤–æ–ø—Ä–æ—Å–æ–≤, –≤—Å–µ –æ—Ç–≤–µ—Ç—ã —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –≤ –ø—Ä–æ–º–ø—Ç, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è 1 –ø–æ—Å—Ç.

---

## ‚úèÔ∏è –≠–¢–ê–ü 6: –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–ï –°–ì–ï–ù–ï–†–ò–†–û–í–ê–ù–ù–´–• –ü–û–°–¢–û–í

### 6.1 –§–ª–æ—É —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
**–ó–∞–¥–∞—á–∏:**
- [x] Handler –¥–ª—è –∫–Ω–æ–ø–∫–∏ "‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å"
- [x] –ó–∞–ø—Ä–æ—Å —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: "–ß—Ç–æ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ –ø–æ—Å—Ç–µ?"
- [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (–∏—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞)
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ
- [x] –°–±–æ—Ä –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–∏—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç + –∑–∞–ø—Ä–æ—Å –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ + –¥–∞–Ω–Ω—ã–µ –ù–ö–û)
- [x] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–≥–æ –ø–æ—Å—Ç–∞ (–∑–∞–≥–ª—É—à–∫–∞)
- [x] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–≥–æ –ø–æ—Å—Ç–∞
- [x] –í–æ–∑–≤—Ä–∞—Ç –∫ —ç–∫—Ä–∞–Ω—É —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏

**–§–∞–π–ª—ã:**
- `src/bot/states.py` - –¥–æ–±–∞–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ `TextGenerationStates` –∏ `TextGenerationStructStates`
- `src/bot/handlers/text_generation.py` - handlers –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
- `src/bot/handlers/text_generation_struct.py` - handlers –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ–æ—Ä–º—ã
- `src/services/prompt_builder.py` - –º–µ—Ç–æ–¥ –¥–ª—è —Å–±–æ—Ä–∫–∏ –ø—Ä–æ–º–ø—Ç–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∑–∞–ø—Ä–æ—Å–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø–æ—Å—Ç–µ, –ø–æ–ª—É—á–∏—Ç—å –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é.

---

## üé® –≠–¢–ê–ü 7: –ì–ï–ù–ï–†–ê–¶–ò–Ø –ö–ê–†–¢–ò–ù–ö–ò (–ó–ê–ì–õ–£–®–ö–ê)

### 7.1 –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
**–ó–∞–¥–∞—á–∏:**
- [ ] –°–æ–∑–¥–∞—Ç—å State –∫–ª–∞—Å—Å `ImageGenerationStates`
- [ ] Handler –¥–ª—è –∫–Ω–æ–ø–∫–∏ "üé® –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç–∏–Ω–∫–∏"
- [ ] –°–æ–æ–±—â–µ–Ω–∏–µ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π
- [ ] Handler –¥–ª—è —Ç–µ–∫—Å—Ç–∞ –∏–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- [ ] –ó–∞–≥–ª—É—à–∫–∞: "–§—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–∑–∂–µ"
- [ ] –ö–Ω–æ–ø–∫–∞ "üîô –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é"

**–§–∞–π–ª—ã:**
- `src/bot/states.py` - –¥–æ–±–∞–≤–∏—Ç—å `ImageGenerationStates`
- `src/bot/handlers/image_generation.py` - —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –∑–∞–≥–ª—É—à–∫—É –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–∞—Ä—Ç–∏–Ω–æ–∫.

---

## üîß –≠–¢–ê–ü 8: –î–û–†–ê–ë–û–¢–ö–ê –ò –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø

### 8.1 –£–ª—É—á—à–µ–Ω–∏—è UX
**–ó–∞–¥–∞—á–∏:**
- [ ] –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –≤–æ –≤—Å–µ—Ö handlers
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö
- [ ] –£–ª—É—á—à–∏—Ç—å —Ç–µ–∫—Å—Ç—ã —Å–æ–æ–±—â–µ–Ω–∏–π (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥" —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### 8.2 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Redis
**–ó–∞–¥–∞—á–∏:**
- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ù–ö–û –≤ Redis
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –ù–ö–û
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

**–§–∞–π–ª—ã:**
- `src/services/nko_service.py` - –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å –º–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç—ã —Å Redis
- `src/services/prompt_builder.py` - –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å —Å–±–æ—Ä–∫—É –ø—Ä–æ–º–ø—Ç–æ–≤

### 8.3 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
**–ó–∞–¥–∞—á–∏:**
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ñ–ª–æ—É –≤—Ä—É—á–Ω—É—é
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å Redis
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É edge cases (–ø—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ, –æ—Ç–º–µ–Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏–π –∏ —Ç.–¥.)

---

## üìä –°–¢–†–£–ö–¢–£–†–ê –§–ê–ô–õ–û–í –ü–†–û–ï–ö–¢–ê

```
src/
‚îú‚îÄ‚îÄ main.py                    # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ config.py                  # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (—É–∂–µ –µ—Å—Ç—å)
‚îú‚îÄ‚îÄ bot/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py            # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞ (—É–∂–µ –µ—Å—Ç—å)
‚îÇ   ‚îú‚îÄ‚îÄ states.py              # –í—Å–µ State –∫–ª–∞—Å—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ keyboards.py           # –í—Å–µ inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ middlewares.py         # Middleware (—É–∂–µ –µ—Å—Ç—å)
‚îÇ   ‚îî‚îÄ‚îÄ handlers/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py        # –†–æ—É—Ç–µ—Ä handlers (—É–∂–µ –µ—Å—Ç—å)
‚îÇ       ‚îú‚îÄ‚îÄ start.py           # /start –∫–æ–º–∞–Ω–¥–∞ (—É–∂–µ –µ—Å—Ç—å)
‚îÇ       ‚îú‚îÄ‚îÄ menu.py            # –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
‚îÇ       ‚îú‚îÄ‚îÄ nko_data.py        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ù–ö–û
‚îÇ       ‚îú‚îÄ‚îÄ help.py            # –ü–æ–º–æ—â—å
‚îÇ       ‚îú‚îÄ‚îÄ text_generation.py # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ (—Å–≤–æ–±–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç)
‚îÇ       ‚îú‚îÄ‚îÄ text_generation_struct.py # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ (—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞)
‚îÇ       ‚îî‚îÄ‚îÄ image_generation.py # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ (–∑–∞–≥–ª—É—à–∫–∞)
‚îî‚îÄ‚îÄ services/
    ‚îú‚îÄ‚îÄ nko_service.py         # –†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –ù–ö–û –≤ Redis
    ‚îú‚îÄ‚îÄ prompt_builder.py      # –°–±–æ—Ä–∫–∞ –ø—Ä–æ–º–ø—Ç–æ–≤ –¥–ª—è AI
    ‚îî‚îÄ‚îÄ text_generation_service.py # –ó–∞–≥–ª—É—à–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞
```

---

## üéØ –ü–†–ò–û–†–ò–¢–ï–¢–´ –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

1. **–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:**
   - –≠—Ç–∞–ø 1: –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
   - –≠—Ç–∞–ø 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ–± –ù–ö–û
   - –≠—Ç–∞–ø 4: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ (—Å–≤–æ–±–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç)

2. **–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:**
   - –≠—Ç–∞–ø 3: –ü–æ–º–æ—â—å
   - –≠—Ç–∞–ø 5: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ (—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞)
   - –≠—Ç–∞–ø 6: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–æ–≤

3. **–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:**
   - –≠—Ç–∞–ø 7: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ (–∑–∞–≥–ª—É—à–∫–∞)
   - –≠—Ç–∞–ø 8: –î–æ—Ä–∞–±–æ—Ç–∫–∞ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

---

## üìù –ó–ê–ú–ï–¢–ö–ò –ü–û –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

1. **FSM States:** –°–æ–∑–¥–∞–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ State –∫–ª–∞—Å—Å—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–ª–æ—É:
   - `MainMenuStates` (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω)
   - `NKODataStates` (–¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö)
   - `TextGenerationStates` (–¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞ - —Å–≤–æ–±–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç)
   - `TextGenerationStructStates` (–¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞ - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞)
   - `ImageGenerationStates` (–¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–∞—Ä—Ç–∏–Ω–æ–∫)

2. **Redis —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
   - –ö–ª—é—á –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –ù–ö–û: `nko_data:{user_id}`
   - –í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ FSM —Ö—Ä–∞–Ω—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ RedisStorage

3. **–ü—Ä–æ–º–ø—Ç—ã:** –ù–∞ –¥–∞–Ω–Ω–æ–º —ç—Ç–∞–ø–µ —Å–æ–±–∏—Ä–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã, –Ω–æ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤ AI. –°–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ Redis –∏–ª–∏ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.

4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** –í—Å–µ handlers –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å try/except –±–ª–æ–∫–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫.

5. **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –ü—Ä–æ–≤–µ—Ä—è—Ç—å –≤–≤–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ (–Ω–µ –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏, –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∏ —Ç.–¥.)

---

## ‚úÖ –ö–†–ò–¢–ï–†–ò–ò –ì–û–¢–û–í–ù–û–°–¢–ò

–ü—Ä–æ–µ–∫—Ç —Å—á–∏—Ç–∞–µ—Ç—Å—è –≥–æ—Ç–æ–≤—ã–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç—Ç–∞–ø—É (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è AI), –∫–æ–≥–¥–∞:
- [ ] –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–ª–æ—É —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –î–∞–Ω–Ω—ã–µ –ù–ö–û —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ Redis
- [ ] –ü—Ä–æ–º–ø—Ç—ã —Å–æ–±–∏—Ä–∞—é—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ –∏ –≥–æ—Ç–æ–≤—ã –∫ –ø–µ—Ä–µ–¥–∞—á–µ –≤ AI
- [ ] –í—Å–µ handlers –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ `return`
- [ ] –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
- [ ] –ö–æ–¥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –∏–∑ requirements.md

